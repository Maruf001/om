

<!doctype html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>cfelpyutils package &#8212; cfelpyutils 0.5 documentation</title>
    <link rel="stylesheet" href="_static/bizstyle.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.5',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/bizstyle.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <!--[if lt IE 9]>
    <script type="text/javascript" src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">cfelpyutils 0.5 documentation</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">cfelpyutils package</a><ul>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-cfelpyutils.crystfel_utils">cfelpyutils.crystfel_utils module</a></li>
<li><a class="reference internal" href="#module-cfelpyutils.geometry_utils">cfelpyutils.geometry_utils module</a></li>
<li><a class="reference internal" href="#module-cfelpyutils.hdf5_utils">cfelpyutils.hdf5_utils module</a></li>
<li><a class="reference internal" href="#module-cfelpyutils.parameter_utils">cfelpyutils.parameter_utils module</a></li>
<li><a class="reference internal" href="#module-cfelpyutils.psana_utils">cfelpyutils.psana_utils module</a></li>
<li><a class="reference internal" href="#module-cfelpyutils">Module contents</a></li>
</ul>
</li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/cfelpyutils.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="cfelpyutils-package">
<h1>cfelpyutils package<a class="headerlink" href="#cfelpyutils-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-cfelpyutils.crystfel_utils">
<span id="cfelpyutils-crystfel-utils-module"></span><h2>cfelpyutils.crystfel_utils module<a class="headerlink" href="#module-cfelpyutils.crystfel_utils" title="Permalink to this headline">¶</a></h2>
<p>Utilities for interoperability with the CrystFEL software package.</p>
<p>This module contains reimplementation of Crystfel functions and utilities.</p>
<dl class="function">
<dt id="cfelpyutils.crystfel_utils.load_crystfel_geometry">
<code class="descclassname">cfelpyutils.crystfel_utils.</code><code class="descname">load_crystfel_geometry</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#cfelpyutils.crystfel_utils.load_crystfel_geometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a CrystFEL geometry file into a dictionary.</p>
<p>Reimplementation of the get_detector_geometry_2 function from CrystFEL
almost verbatim. Returns a dictionary with the geometry information.
Entries in the geometry file appears as keys in the returned dictionary.
For a full documentation on the CrystFEL geometry format, see:</p>
<p>tfel/manual-crystfel_geometry.html</p>
<p>he code of this function is synced with the code of the function
‘get_detector_geometry_2’ in CrystFEL at commit
41a8fa9819010fe8ddeb66676fee717f5226c7b8.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>filename</strong> (<em>str</em>) – filename of the geometry file.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">dictionary with the geometry loaded from the file.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">detector (dict)</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-cfelpyutils.geometry_utils">
<span id="cfelpyutils-geometry-utils-module"></span><h2>cfelpyutils.geometry_utils module<a class="headerlink" href="#module-cfelpyutils.geometry_utils" title="Permalink to this headline">¶</a></h2>
<p>Utilities for CrystFEL-style geometry files.</p>
<p>This module contains utilities for the processing of CrystFEL-style geometry
files.</p>
<dl class="class">
<dt id="cfelpyutils.geometry_utils.ImageShape">
<em class="property">class </em><code class="descclassname">cfelpyutils.geometry_utils.</code><code class="descname">ImageShape</code><span class="sig-paren">(</span><em>ss</em>, <em>fs</em><span class="sig-paren">)</span><a class="headerlink" href="#cfelpyutils.geometry_utils.ImageShape" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">tuple</span></code></p>
<dl class="attribute">
<dt id="cfelpyutils.geometry_utils.ImageShape.fs">
<code class="descname">fs</code><a class="headerlink" href="#cfelpyutils.geometry_utils.ImageShape.fs" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="attribute">
<dt id="cfelpyutils.geometry_utils.ImageShape.ss">
<code class="descname">ss</code><a class="headerlink" href="#cfelpyutils.geometry_utils.ImageShape.ss" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="cfelpyutils.geometry_utils.PixelMaps">
<em class="property">class </em><code class="descclassname">cfelpyutils.geometry_utils.</code><code class="descname">PixelMaps</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>r</em><span class="sig-paren">)</span><a class="headerlink" href="#cfelpyutils.geometry_utils.PixelMaps" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">tuple</span></code></p>
<dl class="attribute">
<dt id="cfelpyutils.geometry_utils.PixelMaps.r">
<code class="descname">r</code><a class="headerlink" href="#cfelpyutils.geometry_utils.PixelMaps.r" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="attribute">
<dt id="cfelpyutils.geometry_utils.PixelMaps.x">
<code class="descname">x</code><a class="headerlink" href="#cfelpyutils.geometry_utils.PixelMaps.x" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="attribute">
<dt id="cfelpyutils.geometry_utils.PixelMaps.y">
<code class="descname">y</code><a class="headerlink" href="#cfelpyutils.geometry_utils.PixelMaps.y" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="cfelpyutils.geometry_utils.adjust_pixel_maps_for_pyqtgraph">
<code class="descclassname">cfelpyutils.geometry_utils.</code><code class="descname">adjust_pixel_maps_for_pyqtgraph</code><span class="sig-paren">(</span><em>pixel_maps</em><span class="sig-paren">)</span><a class="headerlink" href="#cfelpyutils.geometry_utils.adjust_pixel_maps_for_pyqtgraph" title="Permalink to this definition">¶</a></dt>
<dd><p>Adjust pixel maps for visualization of the data in a pyqtgraph widget.</p>
<p>Adjust the pixel maps for use in a Pyqtgraph’s ImageView widget.
Essentially, the origin of the reference system is moved to the
top-left of the image.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pixel_maps</strong> (<em>tuple</em>) – pixel maps, as returned by the
compute_pixel_maps function in this module.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="docutils">
<dt>a three-element tuple containing two float32 numpy arrays</dt>
<dd>(‘slab’-like pixel maps) with respectively x, y coordinates of the
data pixels as the first two elements, and None as the third.</dd>
</dl>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">tuple</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="cfelpyutils.geometry_utils.apply_pixel_maps">
<code class="descclassname">cfelpyutils.geometry_utils.</code><code class="descname">apply_pixel_maps</code><span class="sig-paren">(</span><em>data_as_slab</em>, <em>pixel_maps</em>, <em>output_array=None</em><span class="sig-paren">)</span><a class="headerlink" href="#cfelpyutils.geometry_utils.apply_pixel_maps" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply geometry in pixel map format to the input data.</p>
<p>Applies geometry, described by pixel maps, to input data in ‘slab’ format.
Turns a 2d array of pixel values into an array containing a representation
of the physical layout of the geometry, keeping the origin of the reference
system at the beam interaction point.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data_as_slab</strong> (<em>ndarray</em>) – the pixel values on which to apply the
geometry, in ‘slab’ format.</li>
<li><strong>pixel_maps</strong> (<em>tuple</em>) – pixel maps, as returned by the
compute_pixel_maps function in this module.</li>
<li><strong>output_array</strong> (<em>Optional</em><em>[</em><em>numpy.ndarray</em><em>]</em>) – array to hold the output.
If the array is not provided, one will be generated automatically.
Defaults to None (No array provided).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><dl class="docutils">
<dt>Array with the same dtype as the input data containing a</dt>
<dd><p class="first last">representation of the physical layout of the geometry (i.e.: the
geometry information applied to the input data).</p>
</dd>
</dl>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="cfelpyutils.geometry_utils.compute_minimum_image_size">
<code class="descclassname">cfelpyutils.geometry_utils.</code><code class="descname">compute_minimum_image_size</code><span class="sig-paren">(</span><em>pixel_maps</em><span class="sig-paren">)</span><a class="headerlink" href="#cfelpyutils.geometry_utils.compute_minimum_image_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the minimum size of an image that can represent the geometry.</p>
<p>Compute the minimum size of an image that can contain a
representation of the geometry described by the pixel maps, assuming
that the image is center at the center of the reference system.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>pixel_maps</strong> (<em>tuple</em>) – pixel maps, as returned by the</li>
<li><strong>function in this module.</strong> (<a class="reference internal" href="#cfelpyutils.geometry_utils.compute_pixel_maps" title="cfelpyutils.geometry_utils.compute_pixel_maps"><em>compute_pixel_maps</em></a>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">numpy shape object describing the minimum image size.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="cfelpyutils.geometry_utils.compute_pixel_maps">
<code class="descclassname">cfelpyutils.geometry_utils.</code><code class="descname">compute_pixel_maps</code><span class="sig-paren">(</span><em>geometry</em><span class="sig-paren">)</span><a class="headerlink" href="#cfelpyutils.geometry_utils.compute_pixel_maps" title="Permalink to this definition">¶</a></dt>
<dd><p>Create pixel maps from a CrystFEL geometry object.</p>
<p>Compute pixel maps from a CrystFEL-style geometry object (A dictionary
returned by the load_crystfel_geometry function from the crystfel_utils
module). The pixel maps can be used to create a representation of
the physical layout of the geometry, keeping the origin of the reference
system at the beam interaction point.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>geometry</strong> (<em>dict</em>) – A CrystFEL geometry object (A dictionary returned by
the load_crystfel_geometry function from the crystfel_utils
module).</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="docutils">
<dt>a tuple containing three float32 numpy arrays (‘slab’-like pixel</dt>
<dd>maps) with respectively x, y coordinates of the data pixels and
distance of each pixel from the center of the reference system.</dd>
</dl>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">tuple</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-cfelpyutils.hdf5_utils">
<span id="cfelpyutils-hdf5-utils-module"></span><h2>cfelpyutils.hdf5_utils module<a class="headerlink" href="#module-cfelpyutils.hdf5_utils" title="Permalink to this headline">¶</a></h2>
<p>Utilities for HDF5 files.</p>
<p>This module contains utilities for the processing of HDF5. This module builds
on what the h5py module already provides.</p>
<dl class="function">
<dt id="cfelpyutils.hdf5_utils.load_nparray_from_hdf5_file">
<code class="descclassname">cfelpyutils.hdf5_utils.</code><code class="descname">load_nparray_from_hdf5_file</code><span class="sig-paren">(</span><em>data_filename</em>, <em>data_group</em><span class="sig-paren">)</span><a class="headerlink" href="#cfelpyutils.hdf5_utils.load_nparray_from_hdf5_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a numpy.ndarray from an HDF5 file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data_filename</strong> (<em>str</em>) – filename of the file to read.</li>
<li><strong>data_group</strong> (<em>str</em>) – internal HDF5 path of the data block containing</li>
<li><strong>array to load.</strong> (<em>the</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">numpy array with the data read from the file.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-cfelpyutils.parameter_utils">
<span id="cfelpyutils-parameter-utils-module"></span><h2>cfelpyutils.parameter_utils module<a class="headerlink" href="#module-cfelpyutils.parameter_utils" title="Permalink to this headline">¶</a></h2>
<p>Utilities for parsing command line options and configuration files.</p>
<p>This module contains utilities for parsing of command line options and
configuration files.</p>
<dl class="function">
<dt id="cfelpyutils.parameter_utils.convert_parameters">
<code class="descclassname">cfelpyutils.parameter_utils.</code><code class="descname">convert_parameters</code><span class="sig-paren">(</span><em>config_dict</em><span class="sig-paren">)</span><a class="headerlink" href="#cfelpyutils.parameter_utils.convert_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert strings in parameter dictionaries to the corrent data type.</p>
<p>Read a parameter dictionary returned by the ConfigParser python module,
and assign correct types to the parameters, without changing the structure
of the dictionary.</p>
<p>Try to interpret each entry in the dictionary according to the following
rules. The first rule that returns an valid result determines the type in
which the entry will be converted.</p>
<ul>
<li><p class="first">If the entry starts and ends with a single quote or double quote, it is
interpreted as a string.</p>
</li>
<li><p class="first">If the entry starts and ends with a square bracket, it is interpreted as
a list.</p>
</li>
<li><p class="first">If the entry starts and ends with a brace, it is interpreted as a
dictionary.</p>
</li>
<li><p class="first">If the entry is the word None, without quotes, then the entry is
interpreted as NoneType.</p>
</li>
<li><p class="first">If the entry is the word False, without quotes, then the entry is
interpreted as a boolean False.</p>
</li>
<li><p class="first">If the entry is the word True, without quotes, then the entry is
interpreted as a boolean True.</p>
</li>
<li><p class="first">If none of the previous options match the content of the entry,
the parser tries to interpret the entry in order as:</p>
<blockquote>
<div><ul class="simple">
<li>An integer number.</li>
<li>A float number.</li>
<li>A string.</li>
</ul>
</div></blockquote>
</li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>config</strong> (<em>dict</em>) – a dictionary containing the parameters as strings
(the dictionary as returned by COnfig Parser).</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="docutils">
<dt>dictionary with the same structure as the input</dt>
<dd>dictionary, but with correct types assigned to each entry.</dd>
</dl>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-cfelpyutils.psana_utils">
<span id="cfelpyutils-psana-utils-module"></span><h2>cfelpyutils.psana_utils module<a class="headerlink" href="#module-cfelpyutils.psana_utils" title="Permalink to this headline">¶</a></h2>
<p>Utilities for the psana python module.</p>
<p>This module provides utilities that build on the functionality provided by the
psana python module (developed at the SLAC National Laboratories).</p>
<dl class="function">
<dt id="cfelpyutils.psana_utils.first_event_inspection">
<code class="descclassname">cfelpyutils.psana_utils.</code><code class="descname">first_event_inspection</code><span class="sig-paren">(</span><em>source</em><span class="sig-paren">)</span><a class="headerlink" href="#cfelpyutils.psana_utils.first_event_inspection" title="Permalink to this definition">¶</a></dt>
<dd><p>Inspect the content of the first psana event.</p>
<p>Takes  psana source string (e.g. exp=CXI/cxix….) and inspect the
content in the first event in the data described by the string.
Print information about the the content of the event.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>source</strong> (<em>str</em>) – a psana source string (e.g. exp=CXI/cxix….).</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-cfelpyutils">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-cfelpyutils" title="Permalink to this headline">¶</a></h2>
<p>Utilities for CFEL software projects.</p>
<p>This module provides utilities (functions, classes, etc.) used by many CFEL projects.</p>
<p>It contains the following submodules (non of which are automatically imported):</p>
<p>cfelfabio: utilities based on the fabio python module (a module that allows
python to work with several file format used in x-ray imaging).</p>
<p>cfelgeom: utilities for processing CrystFEL-style geometry files.</p>
<p>cfelhdf5: utilities for processing HDF5 files (based on the h5py python module).</p>
<p>cfeloptarg: utilities to parse command line arguments and parameter files.</p>
<p>cfelpsana: utilities that expand the functionality of the psana python module.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">cfelpyutils 0.5 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2016, CFEL Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.3.
    </div>
  </body>
</html>